<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <title>Föräldraenkät – Smultronet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #f4f6f8;
      padding: 1rem;
    }
    .container {
      max-width: 600px;
      background: #fff;
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0,0,0,.08);
      margin: auto;
    }
    h1 { font-size: 1.4rem; }
    label { display: block; margin-top: 1rem; font-weight: 600; }
    input, select, textarea, button {
      width: 100%;
      padding: .6rem;
      margin-top: .3rem;
      font-size: 1rem;
    }
    button {
      margin-top: 1.5rem;
      background: #005aa7;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>

<body>
<div class="container">
  <h1 id="title">Föräldraenkät – Smultronet</h1>

  <label>
    Språk / Language
    <select id="language" onchange="updateLanguage(this.value)">
      <option value="sv">Svenska</option>
      <option value="en">English</option>
      <option value="ar">العربية</option>
      <option value="so">Soomaali</option>
      <option value="am">አማርኛ</option>
    </select>
  </label>

  <form id="surveyForm">
    <label id="parentNameLabel">Förälderns namn</label>
    <input id="parentName" required />

    <label id="parentEmailLabel">Förälderns e-post</label>
    <input id="parentEmail" type="email" required />

    <label id="childNameLabel">Ungdomens namn</label>
    <input id="childName" required />

    <label id="q1Label">Hur nöjd är du med verksamheten?</label>
    <select id="q1">
      <option value="5">Mycket nöjd</option>
      <option value="4">Nöjd</option>
      <option value="3">Varken eller</option>
      <option value="2">Missnöjd</option>
      <option value="1">Mycket missnöjd</option>
    </select>

    <label id="q2Label">Hur upplever du personalens bemötande?</label>
    <select id="q2">
      <option value="5">Mycket bra</option>
      <option value="4">Bra</option>
      <option value="3">Okej</option>
      <option value="2">Dåligt</option>
      <option value="1">Mycket dåligt</option>
    </select>

    <label id="commentLabel">Övriga kommentarer</label>
    <textarea id="comment"></textarea>

    <button type="submit" id="submitBtn">Skicka</button>
  </form>
</div>

<script src="firebase-config.js"></script>
<script src="email.js"></script>

<script>
emailjs.init("YOUR_PUBLIC_KEY");

const texts = {
  sv: {
    title: "Föräldraenkät – Smultronet",
    parentName: "Förälderns namn",
    parentEmail: "Förälderns e-post",
    childName: "Ungdomens namn",
    q1: "Hur nöjd är du med verksamheten?",
    q2: "Hur upplever du personalens bemötande?",
    comment: "Övriga kommentarer",
    submit: "Skicka"
  },
  en: {
    title: "Parent Survey – Smultronet",
    parentName: "Parent's name",
    parentEmail: "Parent's email",
    childName: "Child's name",
    q1: "How satisfied are you with the service?",
    q2: "How do you experience the staff?",
    comment: "Additional comments",
    submit: "Submit"
  },
  ar: {
    title: "استبيان أولياء الأمور – سمولترونيت",
    parentName: "اسم ولي الأمر",
    parentEmail: "البريد الإلكتروني",
    childName: "اسم الشاب",
    q1: "ما مدى رضاك عن النشاط؟",
    q2: "كيف تقيم تعامل الموظفين؟",
    comment: "ملاحظات إضافية",
    submit: "إرسال"
  },
  so: {
    title: "Sahanka Waalidka – Smultronet",
    parentName: "Magaca waalidka",
    parentEmail: "Iimeylka waalidka",
    childName: "Magaca dhalinyarada",
    q1: "Sidee ayaad ugu qanacsan tahay adeegga?",
    q2: "Sidee ayaad u aragtaa shaqaalaha?",
    comment: "Faallooyin kale",
    submit: "Dir"
  },
  am: {
    title: "የወላጆች ጥናት – Smultronet",
    parentName: "የወላጅ ስም",
    parentEmail: "የኢሜይል አድራሻ",
    childName: "የወጣቱ ስም",
    q1: "ከአገልግሎቱ ምን ያህል ተረክተዋል?",
    q2: "የሰራተኞቹን አገናኝ እንዴት ታያላችሁ?",
    comment: "ተጨማሪ አስተያየቶች",
    submit: "ላክ"
  }
};

function updateLanguage(lang) {
  document.getElementById("title").innerText = texts[lang].title;
  parentNameLabel.innerText = texts[lang].parentName;
  parentEmailLabel.innerText = texts[lang].parentEmail;
  childNameLabel.innerText = texts[lang].childName;
  q1Label.innerText = texts[lang].q1;
  q2Label.innerText = texts[lang].q2;
  commentLabel.innerText = texts[lang].comment;
  submitBtn.innerText = texts[lang].submit;
}

updateLanguage("sv");

document.getElementById("surveyForm").addEventListener("submit", async e => {
  e.preventDefault();

  const data = {
    parentName: parentName.value,
    parentEmail: parentEmail.value,
    childName: childName.value,
    q1: q1.value,
    q2: q2.value,
    comment: comment.value,
    created: new Date()
  };

  await db.collection("enkater").add(data);

  const summary =
`Ungdom: ${data.childName}
Nöjdhet: ${data.q1}
Personal: ${data.q2}
Kommentar: ${data.comment || "-"}`;

  const ok = await skickaBekräftelse(
    data.parentName,
    data.parentEmail,
    data.childName,
    summary,
    data.comment
  );

  alert(ok ? "Tack! Enkäten är skickad." : "E-post kunde inte skickas");
});
</script>
</body>
</html>
