<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Smultronet 2026 – Föräldraenkät</title>

  <!-- PWA-manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#005AA5">

  <style>
    :root {
      --blue-1: #005AA5; --blue-2: #0072C6; --blue-3: #0094DA;
      --gray-1: #F5F5F5; --gray-2: #E0E0E0; --orange: #FFA726;
      --text: #333333;
    }
    *,*::before,*::after {box-sizing:border-box;margin:0;padding:0;}
    body {font-family:"Source Sans Pro",Arial,sans-serif;background:var(--gray-1);color:var(--text);line-height:1.5;}
    header {background:var(--blue-1);color:#fff;padding:1rem;display:flex;align-items:center;gap:0.75rem;}
    header img {height:40px;}
    header h1 {font-size:1.25rem;margin:0;}

    #install-banner {
      display:none;
      background:#e6f0fa;
      color:#003366;
      padding:0.75rem 1rem;
      font-size:0.9rem;
      display:flex;
      align-items:center;
      justify-content:space-between;
    }
    #install-banner button {
      background:var(--blue-2);
      color:#fff;
      border:none;
      padding:0.4rem 0.8rem;
      font-size:0.85rem;
      border-radius:4px;
      cursor:pointer;
    }

    .info-box {background:#fff;border-left:4px solid var(--orange);margin:1rem;padding:1rem;border-radius:4px;font-size:0.9rem;}
    .info-box h2 {color:var(--blue-1);font-size:1rem;margin-bottom:0.5rem;}

    form {background:#fff;margin:1rem;padding:1rem;border-radius:4px;box-shadow:0 1px 3px rgba(0,0,0,0.1);}
    form label {display:block;margin-top:0.75rem;font-size:0.9rem;}
    form input, form select, form textarea {width:100%;padding:0.6rem;margin-top:0.25rem;border:1px solid #ccc;border-radius:4px;font-size:0.9rem;}
    button[type="submit"] {
      width:100%;background:var(--blue-2);color:#fff;padding:0.75rem;font-size:1rem;border:none;border-radius:4px;
    }
    button[type="submit"]:hover {background:var(--blue-3);}
    #status {text-align:center;margin:1rem;font-weight:600;}
    #overlay {display:none;position:fixed;inset:0;background:rgba(0,0,0,0.4);}
    #summary-box {display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:1rem;border-radius:4px;width:90%;max-width:320px;box-shadow:0 2px 6px rgba(0,0,0,0.2);}
    #summary-box h2 {margin-bottom:0.5rem;color:var(--blue-2);font-size:1rem;}
    #summary-box button#close-summary {position:absolute;top:0.5rem;right:0.5rem;background:transparent;border:none;font-size:1.2rem;cursor:pointer;}
    #summary-box pre {font-size:0.85rem;white-space:pre-wrap;}
  </style>
</head>
<body>
  <header>
    <img src="stockholm-logo.png" alt="Stockholms stad logotyp">
    <h1>Smultronet – Föräldraenkät</h1>
  </header>

  <div class="info-box">
    <h2>Hej!</h2>
    <p>Den här enkäten hjälper oss att förbättra Smultronet. Det tar ca 3–5 minuter att svara.</p>
  </div>

  <form id="surveyForm">
    <label>Förälderns namn
      <input type="text" name="parent" required>
    </label>

    <label>Barnets namn
      <input type="text" name="child" required>
    </label>

    <label>Välj språk
      <select name="lang" id="lang">
        <option value="sv">Svenska</option>
        <option value="en">English</option>
        <option value="ar">العربية</option>
        <option value="so">Soomaali</option>
        <option value="am">አማርኛ</option>
      </select>
    </label>

    <label>Hur nöjd är du totalt?
      <select name="q1">
        <option>Mycket nöjd</option>
        <option>Nöjd</option>
        <option>Varken eller</option>
        <option>Missnöjd</option>
        <option>Mycket missnöjd</option>
      </select>
    </label>

    <label>Känner du att ditt barn är tryggt?
      <select name="q2">
        <option>Ja, alltid</option>
        <option>Oftast</option>
        <option>Ibland</option>
        <option>Nej</option>
      </select>
    </label>

    <label>Hur upplever du personalens bemötande?
      <select name="q3">
        <option>Mycket bra</option>
        <option>Bra</option>
        <option>Okej</option>
        <option>Mindre bra</option>
      </select>
    </label>

    <label>Fungerar aktiviteterna bra?
      <select name="q4">
        <option>Ja</option>
        <option>Delvis</option>
        <option>Nej</option>
      </select>
    </label>

    <label>Får du tillräcklig information?
      <select name="q5">
        <option>Ja</option>
        <option>Delvis</option>
        <option>Nej</option>
      </select>
    </label>

    <label>Vad fungerar bra?
      <textarea name="q6" rows="3"></textarea>
    </label>

    <label>Vad kan bli bättre?
      <textarea name="q7" rows="3"></textarea>
    </label>

    <button type="submit">Skicka</button>
  </form>

  <p id="status"></p>

  <div id="overlay"></div>
  <div id="summary-box">
    <button id="close-summary">×</button>
    <h2>Din sammanfattning</h2>
    <pre id="summary-content"></pre>
  </div>

  <script>
    const form = document.getElementById("surveyForm");
    form.addEventListener("submit", async e=>{
      e.preventDefault();
      const data = Object.fromEntries(new FormData(form).entries());

      try{
        const resp = await fetch("/api/send-form", {
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body: JSON.stringify(data)
        });
        if(!resp.ok) throw new Error("Något gick fel");

        // Visa tack + sammanfattning
        document.getElementById("status").innerText="✅ Tack! Ditt svar är inskickat.";
        let summary = Object.entries(data).map(([k,v])=>`${k}: ${v}`).join("\n");
        document.getElementById("summary-content").innerText = summary;
        document.getElementById("overlay").style.display="block";
        document.getElementById("summary-box").style.display="block";
        document.getElementById("close-summary").onclick = ()=>{
          document.getElementById("overlay").style.display="none";
          document.getElementById("summary-box").style.display="none";
        };
        form.reset();
      }catch(err){
        console.error(err);
        document.getElementById("status").innerText="⚠️ Ett fel uppstod, försök igen senare.";
      }
    });
  </script>
</body>
</html>
